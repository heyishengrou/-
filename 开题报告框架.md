 # 开题报告框架 —— 校园助手（基于 Vue + Spring Boot）

 > 本框架供直接拷贝到开题报告文档使用；已包含配图建议与可直接复用的 Mermaid 模板（可粘贴到支持 Mermaid 的 Markdown/Docs 工具或先在 draw.io 画图后导出 PNG/SVG）。

 ---

 ## 一、选题背景与课题来源（引出论文题目）
 ### 1.1 课题来源（实际项目场景）
 - 校园数字化转型需求：信息入口分散、流程复杂、跨系统体验不一致。
 - 使用对象与场景：学生（课表/导航/信息）、教师（公告/互动）、管理员（内容/设备）。
 - 数据与系统：校内通知、流程指引、课程信息、地图/POI、论坛互动、IoT 设备数据。

 ### 1.2 相关领域问题与关键需求（简述，科研性可带过）
 - 通用大模型不具备校内知识与执行工具，答案可用性不足。
 - 校园信息碎片化、跨系统协同弱、移动端体验不一致。
 - IoT 数据孤岛，难以与业务应用联动。

 ### 1.3 本论文聚焦的需求范围（简述）
 - 基于 Vue + Spring Boot 的校园综合服务平台（前后端分离）。
 - AI 助手（RAG + 工具调用/任务编排）提升“有据可依”“能执行”的问答体验。
 - 核心业务：论坛/点评、校园导航、课表/通知聚合。
 - IoT 接入：温湿度传感器全链路；可选扩展导航小车（高工作量）。

 ---

 ## 二、研究内容与系统设计总览（老师快速判断工作量是否达标）
 ### 2.1 系统整体架构（概貌）
 - 前端：Vue 3 + Vite + TS + Pinia + Router；WebSocket 实时推送。
 - 后端：Spring Boot 3 + Security(JWT) + JPA/MyBatis + WebSocket；Redis/MinIO/MQTT。
 - 数据：PostgreSQL（pgvector 用于向量检索）；可选 Elasticsearch 检索。
 - AI：LangChain4j + 本地 Ollama/云端模型；RAG + 工具调用；引用来源。
 - IoT：ESP32 + DHT22 → MQTT → 后端 → 数据库/告警/可视化；（可选）ROS2 导航小车。

 配图建议（任选其一或同时使用）：
 - 图1 系统上下文图（C4 Level 1）：用户、Web/PWA、后端 API、AI 子系统、DB/缓存、MQTT、设备。
 - 图2 容器图（C4 Level 2）：Web、API、AI/RAG、存储、消息、IoT 设备与主题。
 - 图3 部署图（可选）：开发/生产、容器组件、网络与安全边界。

 示例（系统上下文，Mermaid，可直接粘贴渲染）：
 ```mermaid
 flowchart LR
   User[学生/教师/管理员] --> Web[Vue3 Web/PWA]
   Web -->|REST/JWT| API[Spring Boot API]
   Web <-->|WebSocket| API
   API --> DB[(PostgreSQL + pgvector)]
   API --> Redis[(Redis缓存)]
   API --> MinIO[(对象存储)]
   API --> MQTT[(EMQX/Mosquitto)]
   API --> AI[AI服务 RAG/工具编排]
   MQTT <--> Device[ESP32 + DHT22]
 ```

 ### 2.2 需求与可行性分析
 - 功能需求（摘要）：
   - AI 助手（检索增强、工具调用、引用来源、会话记忆）。
   - 论坛/点评（发帖、评论、点赞、举报、搜索、审核）。
   - 校园导航（POI/路径规划/到达时间、无障碍路径）。
   - 教务与通知聚合（本地维护/导入、提醒）。
   - IoT 温湿度看板（实时/历史、阈值告警、设备管理）。
 - 非功能需求：
   - 安全（JWT/RBAC、审计）、性能（缓存/索引）、可用性（降级/重试）、可观测性（日志/指标/追踪）。
 - 业务流程（泳道示意，Mermaid）：
 ```mermaid
 flowchart LR
   subgraph 学生
     A[提出问题/需求]
     B[查看结果/执行建议]
   end
   subgraph 后端/AI
     C[意图识别/路由]
     D[检索RAG]
     E[工具调用/计划编排]
   end
   subgraph 设备/外部
     F[MQTT 传感器]
     G[地图/第三方API]
   end
   A --> C --> D --> E --> B
   F -->|温湿度数据| 后端/AI
   G --> E
 ```

 ### 2.3 功能模块设计（含硬件选型）
 - 模块：用户与权限、AI 助手、论坛/点评、导航、教务/通知、IoT 看板、系统设置与运维。
 - 硬件选型（建议）：
   - 温湿度：ESP32 + DHT22（低成本、接入简易），MQTT QoS1，上报周期 5~60s 可配。
   - 导航小车（可选高阶）：Raspberry Pi 4 + ROS 2（Nav2）+ RPLidar A1/IMU + 电机驱动；后端以 REST/gRPC 下发目标点，订阅状态。
 - 功能模块图（Mermaid）：
 ```mermaid
 flowchart TB
   subgraph Web
     UI[Vue3 前端]
   end
   subgraph API[Spring Boot]
     Auth[JWT/RBAC]
     Forum[论坛/点评]
     Map[校园导航]
     Edu[课表/通知]
     IOT[IoT数据/设备]
     AIService[AI接口]
   end
   subgraph Infra[基础设施]
     DB[(PostgreSQL+pgvector)]
     Cache[(Redis)]
     Obj[(MinIO)]
     MQ[(MQTT)]
   end
   UI --> API
   API --> DB
   API --> Cache
   API --> Obj
   API --> MQ
   API --> AIService
   Device[ESP32+DHT22] <--> MQ
 ```

 ### 2.4 数据描述（关键数据与关系）
 - 关键实体：users、roles、posts、comments、tags、ratings、courses、schedules、buildings、rooms、poi、devices、device_readings、kb_documents、kb_chunks、conversations、messages。
 - ER 关系图（Mermaid）：
 ```mermaid
 erDiagram
   USERS ||--o{ POSTS : creates
   POSTS ||--o{ COMMENTS : has
   POSTS }o--o{ TAGS : tagged
   USERS ||--o{ RATINGS : makes
   COURSES ||--o{ COURSE_SCHEDULES : contains
   USERS }o--o{ COURSES : enrolls
   BUILDINGS ||--o{ ROOMS : contain
   POI ||--o{ ROUTES : cached
   DEVICES ||--o{ DEVICE_READINGS : produces
   KB_DOCUMENTS ||--o{ KB_CHUNKS : contains
   USERS ||--o{ CONVERSATIONS : starts
   CONVERSATIONS ||--o{ MESSAGES : include
 ```

 ### 2.5 通信协议（简述，必要时给出）
 - 上行主题：`campus/iot/{deviceId}/sensor`（QoS1）
 - 下行主题（可选）：`campus/iot/{deviceId}/ctrl`（QoS1）
 - 载荷（JSON 示例）：
 ```json
 {
   "deviceId": "esp32-001",
   "ts": "2025-11-06T08:00:00Z",
   "temperature": 24.1,
   "humidity": 56.3,
   "sig": "HMAC-SHA256(base64)"
 }
 ```
 - 校验：设备密钥生成 HMAC；后端校验签名 + 速率限制 + 异常值过滤。

 ---

 ## 三、实现方案与可行性保证（如何完成）
 ### 3.1 软件关键模块流程（流程图/时序图）
 - RAG 问答（时序图）：
 ```mermaid
 sequenceDiagram
   participant U as User
   participant W as Web
   participant A as API
   participant R as RAG/AI
   participant D as DB/Vector
   U->>W: 提问
   W->>A: POST /ai/ask
   A->>R: 检索请求(问题)
   R->>D: 语义检索(向量+BM25)
   D-->>R: 文档片段Top-k
   R-->>A: 生成回答(含引用)
   A-->>W: 回答与引用
   W-->>U: 展示答案与来源
 ```
 - 工具调用（流程）：
 ```mermaid
 flowchart LR
   Q[用户意图] --> C{是否需要工具}
   C -- 否 --> Gen[直接生成/命中缓存]
   C -- 是 --> T[选择工具集]
   T --> Exec[依次/并行调用]
   Exec --> Merge[合并结果/异常回退]
   Merge --> Gen[生成带引用的结论]
 ```

 ### 3.2 硬件关键模块流程
 - 传感器链路：
 ```mermaid
 flowchart LR
   ESP[ESP32 读取 DHT22] --> Pack[打包JSON+签名]
   Pack --> Pub[MQTT 发布 QoS1]
   Sub[后端订阅主题] --> Verify[验签/频率/异常]
   Pub --> Sub --> Store[入库(时序/聚合)] --> Alert[阈值告警]
   Store --> WS[WebSocket 推送前端]
 ```
 - 导航小车（可选）：
 ```mermaid
 sequenceDiagram
   participant Admin as 管理端
   participant API as 后端API
   participant Car as ROS2小车
   Admin->>API: 下发目标点/路径
   API->>Car: REST/gRPC 任务
   Car-->>API: 位置/状态回传
   API-->>Admin: 实时状态与轨迹
 ```

 ### 3.3 面向对象设计（类图/时序图）
 ```mermaid
 classDiagram
   class AiService {+ask(question): Answer}
   class RagRetriever {+retrieve(query): List<Chunk>}
   class ToolRegistry {+invoke(name,args): Result}
   class ForumService {+createPost(...)}
   class IotService {+onMessage(...)}
   class DeviceService {+register(...)}
   class User ~entity~
   class Post ~entity~
   class Device ~entity~
   AiService --> RagRetriever
   AiService --> ToolRegistry
   ForumService --> Post
   IotService --> DeviceService
 ```

 ### 3.4 数据库设计与算法实现（要点）
 - 数据库：
   - 向量：`kb_chunks(id, doc_id, content, embedding vector)` + pgvector 索引。
   - 论坛：`posts`、`comments`、`tags`、`post_tags`，建立文本/时间索引。
   - IoT：`devices(device_id, secret, status)`、`device_readings(device_id, ts, t, h)` 分区/时序优化。
 - 通信协议：MQTT QoS1；载荷签名 HMAC；设备白名单与限流。
 - 算法思路：文本切分（标题/语义感知）→ 嵌入 → 多路召回（向量+BM25）→ 重排 → 生成附引用；工具选择基于意图分类/函数描述匹配；缓存命中基于检索签名。

 ---

 ## 附：配图与文档产出指引
 - 工具：draw.io（架构/部署/泳道）、Mermaid（Markdown 直接渲染）、PlantUML（可选）。
 - 命名：存放至 `docs/images/`，命名如 `arch-context.png`、`er.png`、`flows-ai.png`。
 - 写作建议：每幅图配 2~3 句话解释“解决了什么问题/如何协作/关键权衡”。

 > 本框架侧重“判断能否达标”和“如何落地”。可按实际课题来源微调第 1 部分的叙述力度。


